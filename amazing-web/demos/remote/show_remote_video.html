<!DOCTYPE html>
<html>
    <head>
        <script src="http://localhost:1337/socket.io/socket.io.js"></script>
        <script src="../lib/webrtc-adapter.js"></script>
    </head>

    <body>
        <video autoplay></video>
        <canvas></canvas>
        <div></div>
    </body>

    <script type="application/javascript">
        var video = document.querySelector('video'),
                canvas = document.querySelector('canvas');

        createOffer();

        function createOffer() {
            var peer = new RTCPeerConnection(iceServerConfig(), []);

            var socket = io.connect('http://localhost:1337');

            socket.on('message', function(data) {
                if (data.offer) {
                    console.log('got offer: ' + data.offer);
                }
            });
        }


        function iceServerConfig() {
            var isChrome = !!navigator.webkitGetUserMedia;
            var STUN = {
                url: isChrome
                        ? 'stun:stun.l.google.com:19302'
                        : 'stun:23.21.150.121'
            };

            var TURN = {
                url: 'turn:homeo@turn.bistri.com:80',
                credential: 'homeo'
            };

            return {
                iceServers: [STUN, TURN]
            };
        }

    </script>
</html>