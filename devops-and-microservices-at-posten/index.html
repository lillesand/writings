<!doctype html>
<!-- vim: set tabstop=4 softtabstop=4 shiftwidth=4 noexpandtab: -->
<!-- vim: set foldexpr=SectionFold(v\:lnum) : -->
<!-- vim: set foldcolumn=5 foldlevel=99 foldmethod=expr : -->

<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>DevOps og Micro Services hos Posten</title>

		<meta name="description" content="DevOps og Micro Services hos Posten">
		<meta name="author" content="Stian Mathiassen and Jøran Lillesand">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<!--
		<link rel="stylesheet" href="css/theme/black.css" id="theme">
		-->
		<link rel="stylesheet" href="css/theme/bekk.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->

		<style>
			.reveal section img {
				border: none;
			}

			section .header {
				position: relative;
				background-color: black;
			}

			section .header h2 {
				padding: 10px;
			}

			section .header .caption {
				position: absolute;
				font-size: 20px;
				text-align: left;
				background-color:inherit;
				top: -24px;
				padding: 2px 10px;
			}

		</style>
	</head>

	<body>

		<div class="reveal">

			<div class="slides">
				<section id="intro-speakers" data-owner="jøran">
					<section>
						<h2>DevOps og Microservices hos Posten og Bring!</h2>
					</section>

					<section>
						<h1>Hvem er vi?</h1>
						<div style="clear:both"></div>

						<div style="width: 49%; float: left;">
							<img src="img/bekk-stian.png" />
							<p class="">Stian</p>
						</div>
						<div style="width: 49%; float: left;" class="fragment">
							<img src="img/bekk-joran.png" />
							<p class="">Jøran</p>
						</div>
					</section>

					<aside class="notes">
						Typ: 30 sek hver.
						Bittekort bio om hver av oss. Hva gjør vi her? Bakgrunn osv.
						Forslag til twist: bytt om bilde og navn! Sjekk om folk følger med! Hoho!
					</aside>
				</section>

				<section id="intro" data-owner="jøran">
					<section data-background-video="img/sortering.mp4" data-background-video-loop>
						<h2 style="background-color: #e32d22; color: white; padding: 10px; width: auto;">
							IT i Posten
						</h2>

						<aside class="notes">
							Introduksjon av Posten/Bring. Keep it short.

							Mål: IT i Posten Bring er avansert! Mange systemer!

							<ul>
								<li>Alle vet hvem Posten er.</li>
								<li>IT i Posten: Posten er, som mange andre, i stadig større grad en it-virksomhet</li>
								<li>Si noe om størrelsen på IT i Posten: nesten all produksjon er IT-styrt (sortering osv)</li>
								<li>En del vekst gjennom oppkjøp: typisk kjøper seg inn i nye markeder. Bud, Cargo, osv.</li>
								<li>Noe standardprodukt, noe tilpasning, noe skreddersøm.</li>
							</ul>
						</aside>
					</section>

					<section data-background-image="img/bring-web-team.jpg">
						<h2 style="background-color: #7bc144; color: white; padding: 10px;">
							Bring Web Team
						</h2>

						<aside class="notes">
							Om teamet:

							<ul>
								<li>Sped begynnelse i 2008. Jøran rett ut fra NTNU som første utvikler. Det første jeg gjorde var å designe et gigantisk databaseskjema som heldigvis aldri ble brukt.</li>
								<li>Premisset for teamet: smidig! Endre måten Posten gjør software på.</li>
							</ul>
						</aside>
					</section>

					<section data-owner="stian">
						<h1>Hva lager vi?</h1>

						<aside class="notes">
							<ul>
								<li>Få med litt om hvilke tjenester vi har ansvaret for. Dropp et par navn, men fokuser primært på å vise at det ikke bare er noe smått tøyesri.</li>
								<li>Brukstall</li>
								<li>Omsetningstall</li>
								<li>Dette er ikke et rent tech-miljø, men forretningskritiske systemer.</li>
							</ul>
						</aside>
					</section>

					<section data-owner="stian" data-background-image="img/sporing.png" data-background-position="top">
						<aside class="notes">
							<ul>
								<li>Mest kjente løsningen</li>
								<li>En mill sporinger per dag</li>
								<li>50 000 pushmeldinger i døgnet</li>
							</ul>
						</aside>
					</section>

					<section data-owner="stian" data-background-image="img/booking.png" data-background-position="top">
						<aside class="notes">
							<ul>
								<li>I starten ca 5000 kr i uka</li>
								<li>Over 30 000 bestillinger i uka</li>
								<li>Ca 10 mill i omsetning per uke</li>
							</ul>
						</aside>
					</section>

					<section data-owner="stian" data-background-image="img/developer.png" data-background-position="top">
					</section>

					<section data-owner="stian" data-background-image="img/fraktguide.png" data-background-position="top">
						<aside class="notes">
							<ul>
								<li>240 000 prisoppslag per dag</li>
							</ul>
						</aside>
					</section>

					<section>
						<h1>Hva har vi?</h1>
						<aside class="notes">
							Fang oppmerksomheten sånn at folk våkner opp.

							Vi er stolte over hvor langt vi har kommet. Full buzzword compliance:
							<ul>
								<li>instrumentering med Puppet</li>
								<li>nedetidsfri deployment på dagtid</li>
								<li>Automatisert overvåkning av logger basert på terskelverdier</li>
								<li>Logaggregering</li>
							</ul>

							Dette er fortellingen om reisen dit, og hvilke lekser vi har lært på veien.<br>
							Vi tror mye av det vi har lært er universelt. Tenk på hvor din organisasjon er i dag, og se hvilke steg vi har tatt derfra.
						</aside>
					</section>
					<section data-owner="stian" data-background-image="img/dashboard.png" data-background-position="top">
						<aside class="notes">
						</aside>
					</section>
					<section data-owner="stian" data-background-image="img/kibana1.png" data-background-position="top">
					</section>
					<section data-owner="stian" data-background-image="img/kibana2.png" data-background-position="top">
					</section>
					<section data-owner="stian">
						<img src="img/slack.png" alt="Slack">
					</section>

					<!--
					<section data-owner="stian">
						Vis hvor langt vi har kommet:

						* Vis Kibana
						* Vis dashboardet
						* Vis Slack med feilvarsling basert på terskelverdier (automatisert overvåkning)
						* Lag screencast/video av deployment
					</section>
					-->
				</section>

				<section id="hovedpoeng-teaser" data-owner="jøran">
					<section>
						<h1>Konklusjonen</h1>
					</section>

					<section>
						Løs problemene du faktisk har.

						<aside class="notes">
							<ul>
								<li>Det har alltid vært viktig for oss å løse de problemene vi har</li>
								<li>Kjenn til hva andre gjør og hva som er the latest and greatest</li>
								<li>Ikke lag noe bare for å lage det</li>
								<li>De (få) gangene vi har lagd noe uten at det har vært basert på et behov har det blitt lite bra</li>
							</ul>
						</aside>
					</section>
				</section>

				<section id="hoveddel-intro" data-background-image="img/now-for-something-different.jpg" data-owner="jøran">
					<h2 style="background-color: black; padding: 10px; margin-bottom: -250px;">And now for something completely different…</h2>

					<aside class="notes">
						Vi er jævelig glad for det vi har. Nå vil fortelle om det vi har lært på veien dit.
					</aside>
				</section>

				<section id="premisser" data-owner="jøran">

					<section data-background-image="img/o-rly.png">
						<div class="header" style="color: #FB8015">
							<div class="caption">Vi har…</div>
							<h2 style="color: inherit;">
								Begynt med DevOps
							</h2>
						</div>

						<aside class="notes">
							Det er naturlig å begynne historien vår med hvordan vi endte opp med DevOps.

							<ul>
								<li>Slide fra Stein Inge</li>
							</ul>
						</aside>
					</section>

					<section>
						<h1>Smidig<span class="fragment">ish</span></h1>

						<aside class="notes">
							<ul>
								<li>Uregelmessige prodsettinger</li>
								<li>Hadde ingen tilgang til egne QA- eller prodservere</li>
								<li>Alle endringer disse miljøene måtte bestilles gjennom et ITIL-regime</li>
								<li>Endte opp med å bestille prodsettinger up front med mest mulig fleks i når de skulle gjøres</li>
							</ul>
						</aside>
					</section>

					<section data-slide-type="smerte">
						<h2>Ekstern driftsorganisasjon</h2>
						<div class="fragment"><img src="img/poop.png" style="box-shadow: none" /></div>

						<aside class="notes">
							<ul>
								<li>Definér ekstern driftsleverandør (utenfor teamet)</li>
								<li>Spør salen: hvor mange har ekstern drift? Hvor mange fungerer det bra for? Hvor mange av disse er smidige?</li>
								<li>Vi prøvde å lykkes med ekstern drift!</li>
								<li>Roten til det vonde: ulike incentivmodeller</li>
								<li>Marginene på å selge drift er knøttsmå</li>
								<li>Fastpris -> ingen proaktivitet</li>
							</ul>
						</aside>
					</section>

					<section data-slide-type="poeng">
						<h2>DevOps</h2>

						<ul>
							<li>Ikke et mål i seg selv</li>
							<li>Prøv å lykkes med det du har</li>
						</ul>

						<aside class="notes">
							<ul>
								<li>Det kan være utrolig vanskelig å bevege seg mot DevOps i en del organisasjoner</li>
								<li>Ikke målet, men et virkemiddel for å lykkes med forretning</li>
								<li>Vi kommer litt tilbake til hvordan DevOps <em>kan</em> innføres</li>
							</ul>
						</aside>
					</section>

					<section data-slide-type="poeng">
						<h2>DevOps er en konsekvens<br/>av å lykkes med smidig</h2>

						<aside class="notes">
							<ul>
								<li>Vi hadde aldri hørt ordet DevOps</li>
								<li>Vi fikk bestilt servere vi hadde root på selv</li>
								<li>En direkte konsekvens av noe som ikke virket</li>
								<li>Det er umulig å jobbe ekte smidig og levere kontinuerlig verdi dersom utvikling,
									forvaltning og drift gjøres av forskjellige organisasjoner</li>
							</ul>
						</aside>
					</section>
				</section>

				<section id="utfordre-premissene" data-owner="jøran">

					<section data-background="img/jcvd-volvosplitt.jpg">
						<div class="header" style="color: #B79A79">
							<div class="caption">Vi har…</div>
							<h2 style="color: inherit;">
								Utfordret premisser
							</h2>
						</div>

						<aside class="notes">
							<ul>
								<li>Vi var jævelig keene på å gjøre smidig utvikling</li>
								<li>Vi hadde en innkjøper som var keen på smidig utvikling</li>
								<li>Vi var i en organisasjon som var jævelig ukeen på smidig utvikling</li>
							</ul>
						</aside>
					</section>

					<section data-slide-type="smerte">
						<h2>Timingen er aldri riktig</h2>
						<aside class="notes">
							Med mindre du jobber i en IT-bedrift eller en startup vil det alltid være mye baggasje.

							<ul>
								<li>Det var krav for om å bruke ESB</li>
								<li>Krav om fremdriftsrapporter</li>
								<li>Krav om prosjektkontrakt</li>
								<li>Alt var anskaffelsessentrert</li>
							</ul>
						</aside>
					</section>

					<section data-slide-type="poeng">
						<h2>Utfordre premissene</h2>
						<ul>
							<li>Vær litt naughty</li>
							<li>Vær en organisasjon i organisasjonen</li>
							<li>Eksperimenter med nye prosjekter</li>
						</ul>

						<aside class="notes">
							<p>For smidig, DevOps eller MicroServices eller whatever. Du må være forberedt på å ta initiativ selv.</p>

							<p>Men for guds skyld, ha en sponsor.</p>

							<ul>
								<li>Vi spurte ikke om lov til å gjøre DevOps</li>
								<li>Vi snek oss til egen tilgang til 3 servere i en egen sone</li>

								<li>Det er alltid utfordringer med det vi ønsker å gjøre. Where there's a will there's a way.</li>
								<li>Det var mange som var uenige i det vi gjorde, og vi gjorde mye vi egentlig ikke skulle.</li>
							</ul>
						</aside>
					</section>
				</section>

				<section id="start-smått" data-owner="stian">
					<!-- http://www.designswan.com/archives/beautiful-miniature-world-created-by-tilt-shift-photography.html -->
					<section data-background="img/miniature.jpg">
						<div class="header" style="color: #3281AD"><!-- colors: #FBC32B #3281AD -->
							<div class="caption">Vi har…</div>
							<h2 style="color: inherit;">
								Startet smått
							</h2>
						</div>
						<aside class="notes">
							<ul>
								<li>Fikk kontroll på utvikling</li>
								<li>Vil prodsette oftere</li>
								<li>Bruker mye tid per deploy</li>
								<li>Stor appserver</li>
							</ul>
						</aside>
						<!--
						Ville ha mer kontroll på hvordan deployment fungerte,
						siden vi brukte mye tid per deploy. Bestilte egne
						servere, og begynte å automatisere deployment, og
						byttet ut stor appserver med liten container. Prøver ut
						på en (liten) app.
						-->
					</section>

					<section>
						<h2>Egne servere, ny applikasjon</h2>
						<aside class="notes">
							<ul>
								<li>Liten appserver</li>
								<li>Bestiller egne servere</li>
								<li>Ansvar for drift krever kunnskap</li>
							</ul>
						</aside>
						<!--
						Videre gikk på noen problemer mens dette miljøet var i
						startgropa. Lærte mye om drift og at dette faktisk er
						et fag i seg selv. Å ta ansvar for driftsmiljø krever
						mye kunnskap om infrastruktur osv. Et eksempel på en
						mindre smart ting vi gjorde var å eksplodere war-fila
						vår i tmp-folderen som blir wipa regelmessig av OSet.
						Ikke smart.
						-->
					</section>

					<section data-slide-type="tabbe">
						<img src="img/404.png">
						<aside class="notes">
							<ul>
								<li>Jetty exploded war i /tmp/</li>
								<li>Fungerer når vi deployer ofte</li>
								<li>Sletted hver 3. dag</li>
							</ul>
						</aside>
					</section>

					<section data-slide-type="poeng">
						<h2>Start med minimal risiko</h2>
						<aside class="notes">
							<ul>
								<li>Vi begynte med helt ny/liten applikasjon</li>
								<li>Det viktigste er at kompleksiteten i applikasjonen er lav</li>
								<li>… og at risikoen er lav. Folk bør ikke miste jobben dersom det gjøres feil i starten.</li>
								<li>Du har fortsatt mye å lære!</li>
							</ul>
						</aside>
					</section>
				</section>

				<section id="nedetidsfri-deploy" data-owner="stian">
					<!-- http://www.wallconvert.com/wallpapers/space/sunrise-28446.html -->
					<section data-background="img/sunrise.jpg">
						<div class="header" style="color: #FCE677">
							<div class="caption">Vi har…</div>
							<h2 style="color: inherit;">
								Deployet mitt på dagen
							</h2>
						</div>
						<!--
						Etterhvert som infrastrukturen vi driftet selv vokste
						og ble mer stabilt økte hyppigheten på deploys veldig,
						og vi begynte fort å kjenne smerten ved at deployments
						medførte nedetid og var noe omfattende.
						-->
						<aside class="notes">
							<ul>
								<li>Begynte å deploy oftere og oftere</li>
								<li>Få brukere, ikke problem med litt nedetid</li>
							</ul>
						</aside>
					</section>

					<section data-slide-type="tabbe">
						<h2>Nedetid</h2>
						<!--
						Appene vokste. Hyppige deployments. Måtte deploye på
						kveldstid med manuelle steg for å sikre at
						applikasjonen ikke ble utilgjengelig for brukerne.
						-->
						<aside class="notes">
							<ul>
								<li>Begynte å deploy oftere og oftere</li>
								<li>Få brukere, ikke problem med litt nedetid</li>
							</ul>
						</aside>
					</section>

					<section data-slide-type="poeng">
						<h2>Nedetidsfri deploy</h2>
						<aside class="notes">
							<ul>
								<li>Deploy på dagtid</li>
								<li>Alle er på jobb</li>
								<li>NB! Bakoverkompatibilitet</li>
							</ul>
							<!--
							Når applikasjoene deployes ofte begynner det snart
							å gjøre vondt dersom det fører med seg nedetid.
							Dette bør være et prinsipp for alle applikasjoner
							som inngår, inkludert databasen.

							Unngå single point of failures , komponenter som
							ikke kan deployes uten nedetid
							-->
							<br/>
						</aside>
					</section>

					<!--
					<section data-slide-type="visdomsord">
						TODO: Dette er enkelt for webapps, men en jævla pandoras shitbox for persistent state.
					</section>
					-->
				</section>


				<section id="automatisering" data-owner="jøran">
					<section data-background="img/automatisering.jpg">
						<div class="header" style="color: #0CADD1">
							<div class="caption">Vi har…</div>
							<h2 style="color: inherit;">
								Automatisert
							</h2>
						</div>
					</section>

					<section data-slide-type="tabbe">

						<pre style="margin-bottom: 30px;"><code style="font-size:30px; line-height:60px;" data-trim>
							$ be rake production:rollback
						</code></pre>


						<div class="fragment">– not implemented. perform manual rollback.</div>
					</section>

					<section data-slide-type="tabbe">
						<h2>Manual rollback time…</h2>
						<pre style="margin-bottom: 30px;"><code style="font-size:30px; line-height:60px;" data-trim>
							ln -sf booking.jar booking-2.11.jar
						</code></pre>

						<pre class="fragment"><code style="font-size:30px; line-height:60px;" data-trim>
							ln -sf booking-2.11.jar booking.jar
						</code></pre>

						<aside class="notes">
							Hadde begynt å automatisere så smått, men mye manglet. Produksjonssatte bugga versjon av booking. Skulle rulle tilbake<br>

							Hva er riktig syntax for symlink?
						</aside>
					</section>

					<section data-slide-type="poeng">
						<h2>Automatiser alt</h2>

						<ul>
							<li>Deployments</li>
							<li>Konfigurasjon</li>
							<li>Ryddejobber</li>
							<li>Engangsjobber</li>
						</ul>

						<aside class="notes">
							Eksempelet vårt er selvsagt ekstremt. Men automatisering gir
							<ul>
								<li>dokumentasjon (hva har faktisk blitt gjort)</li>
								<li>reproduserbarhet</li>
								<li>likhet på tvers av mijøer</li>
							</ul>
						</aside>
					</section>

					<section data-slide-type="poeng">
						<h1>Automatiser, <span class="fragment">automatiser,</span> <span class="fragment">automatiser!</span></h1>

						<aside class="notes">
							<ul>

								<li>Manuelle operasjoner er roten til mye vondt!</li>
								<li>Tar mye tid og gir mye feil</li>
								<li>Vanskelig å reprodusere og vite hva som har skjedd</li>
							</ul>
						</aside>
					</section>
				</section>

				<section id="overvåkning" data-owner="jøran">
					<section data-background="img/overvåkning.jpg" data-background-repeat="no-repeat" data-background-color="white" data-background-position="center" data-background-size="70%">

						<div class="header" style="background-color: white;">
							<div class="caption">Vi har…</div>
							<h2>
								Overvåket
							</h2>
						</div>
					</section>

					<section data-slide-type="tabbe">
						<img src="img/error-page.png" class="stretch" />

						<aside class="notes">
							Stian ikke så glad i at vi forteller dette fordi vi høres ut som n00bs. Men faen, la oss være ærlige.
							<ul>
								<li>Blir varslet via kundeservice om at en app er nede</li>
								<li>Viser seg at den har vært nede siden kvelden før</li>
								<li>Et n+1-problem, det går alltid ned der du mangler målepunkter</li>
							</ul>
						</aside>
					</section>

					<section data-slide-type="poeng">
						<h2>Overvåkning</h2>

						<ul>
							<li>Mål sluttbrukertransaksjoner</li>
							<li>Automatisk helsesjekk</li>
							<li>Loggovervåkning basert på terskler</li>
						</ul>

						<aside class="notes">
							<ul>
								<li>Om applikasjonen brukes av sluttbrukere er den eneste fasiten på at det er oppe</li>
								<li>One team. Alarmen går til den som har ansvar for tweake den.</li>
								<li>Når du blir vekt x03:58 av en falsk alarm så fikser du den!</li>
								<li>Overvåkning basert på sluttbrukertransaksjoner</li>
							</ul>
						</aside>
					</section>

				</section>

				<section id="lær-drift" data-owner="stian">
					<!-- https://commons.wikimedia.org/wiki/File:Rock_crusher_gears.jpg -->
					<section data-background="img/gears.jpg">
						<div class="header" style="color: #C66659">
							<div class="caption">Vi har…</div>
							<h2 style="color: inherit;">
								Lært driftsfaget
							</h2>
						</div>
						<aside class="notes">
							<ul>
								<li>Til nå en app</li>
								<li>Budsjett til å migrere noen flere</li>
								<li>Drift er eget fagfelt!</li>
							</ul>
							<!--
							Mens vi stadig migrerte mer kritiske applikasjoner
							over på ny infrastruktur som vi driftet selv, ble
							vi tvunget til å se i øyene at drift faktisk er et
							fagfelt. Vi gikk på flere smeller med backup,
							overvåkning, hardening og så videre. Det som er
							interessant å se i ettertid er hvordan våre
							løsninger på konkrete problemer har ledet oss til
							infrastruktur som er helt i henhold til det som
							beskrives i DevOps-litteratur – med noen
							interessante unntak.
							-->
						</aside>
					</section>

					<section data-slide-type="tabbe">
						<h2>Ting tar tid</h2>
						<!--
						Tok litt tid før vi etablerte mye av det som
						kommer "ut av boksen" når man kjøper ferdig drift.
						Backup, overvåkning, hardening av hosts.
						-->
						<aside class="notes">
							<ul>
								<li>Flere smeller med backup, overvåkning, hardening</li>
								<li>Mangler det man får ut av boksen</li>
								<li>Bruker utviklerpraksis i drift. Tester, automatisering, verifisering</li>
								<li>Kontroll på at det virker</li>
								<li>Lave marginer i drift, lite proaktive</li>
							</ul>
						</aside>
					</section>

					<section data-slide-type="poeng">
						<h2>Lær drift</h2>
						<aside class="notes">
							Mye å lære om drift. Du kan det antagelig ikke.
							<ul>
								<li>Sikkerhet: OS-hardening</li>
								<li>Sonemodeller</li>
								<li>Virtualisering</li>
								<li>Nettverk</li>
								<li>Backup</li>
								<li>Overvåkning</li>
							</ul>
						</aside>
					</section>
				</section>

				<section id="micro-services-the-beginning" data-owner="jøran">
					<section data-background-image="img/neural-network.jpg">
						<div class="header" style="color: #E2E7CF">
							<div class="caption">Vi har…</div>
							<h2 style="color: inherit;">
								Flyttet kompleksitet
							</h2>
						</div>

						<aside class="notes">
							<ul>
								<li>Når store applikasjoner ble flyttet merket vi smerten ved store applikasjoner bedre.</li>
								<li>Det er en ting å deploye en lettbent, liten applikasjon ofte, men når beistet begynner å bli mange hundre tusen kodelinjer er det ikke like gøy.</li>
								<li>Uten at vi hadde ord for det vi drev på med, begynte vi å fokusere på å bryte opp funksjonalitet og unngå å la de store appene våre vokse videre.</li>
							</ul>

						</aside>
					</section>


					<section data-slide-type="tabbe">
						<h2>Vår venn monolitten</h2>
						<ul>
							<li>Det er mye bra med monolitter!</li>
							<li class="fragment">… men det er faen meg mye dårlig også</li>
						</ul>

						<aside class="notes">
							Det er ikke noe feil med monolitter i seg selv!

							<ul>
								<li>Lenge fungerte det bra med store applikasjoner</li>
								<li>Men når de større appene kom over på ny infrastruktur ble det verre</li>
								<li>Høyere hyppighet på deploys</li>
								<li>Stor kompleksitet i apper, vanskelig å endre og teste</li>
							</ul>
						</aside>
					</section>

					<section data-slide-type="poeng">
						<h2>En nødvendig konsekvens</h2>
						<ul>
							<li>Fokus på mindre applikasjoner</li>
							<li class="fragment">Flytter kompleksiteten over i samspillet</li>
							<li class="fragment">The Right Size™</li>
						</ul>

						<aside class="notes">
							<ul>
								<li>Splittet aldri opp eksisterende applikasjoner (selv om det var planen!)</li>
								<li>Riktig størrelse for en micro service</li>
								<li>Endringstakt for koden er faktor</li>
								<li>Arkitektur er ikke et mål i seg selv: viktig å gradvis lære seg å drifte små applikasjoner</li>
								<li>Vi lå lenge på 4-5 og vokste sakte. Mye måtte på plass før vi var klare for mange små</li>
							</ul>
						</aside>
					</section>

					<section data-slide-type="poeng" style="width: 110%">
						<h2>
							Micro Services er en konsekvens<br/>
							av å lykkes med DevOps
						</h2>

						<aside class="notes">
							Det er omvendt korrelasjon mellom størrelsen på applikasjonen og hvor ofte de kan deployes. Interessant kausalitet, fordi det driver hverandre begge veier.
						</aside>
					</section>

				</section>

				<section id="devops-er-en-markedsfordel" data-owner="stian">
					<!-- https://en.wikipedia.org/wiki/File:Cash_register,_built_1904_in_Ohio.jpg -->
					<section data-background="img/cashregister.jpg">
						<div class="header">
							<div class="caption">Vi har…</div>
							<h2 style="color: inherit;">
								Fått forretning med på laget
							</h2>
						</div>
						<aside class="notes">
							<ul>
								<li>Hadde kun råd til å migrere noen apper</li>
							</ul>
						</aside>
						<!--
						Etterhvert som stadig flere applikasjoner begynte
						salgsorganisasjonen å irritere seg over at endringer på
						noen applikasjoner kunne komme ut på under en dag, mens
						andre kunne ta opp til flere uker. Hvorfor måtte det
						være sånn!? Det endte med at Salg finansierte
						migreringen av resten av porteføljen over på den nye
						infrastrukturen. Dette ble på mange måte en øyeåpner
						for resten av organisasjonen, som innså at
						infrastruktur er for flere enn IT.
						-->
					</section>

					<section data-slide-type="smerte">
						<h2>Finansiering</h2>
						<aside class="notes">
							<ul>
								<li>Salg/produkteier lei av IT-oppgaver</li>
								<li>"Høye herrer" i IT betaler jo allerede for drift</li>
								<li>Hvorfor betale dobbelt for oss</li>
								<!--
								<li>"De høye herrer" i IT så ikke nytten med at vi kasta masse penger på å drive infrastrukturen på annen måte enn de var vant til. Hvorfor skulle de betale for å vi skulle løse samme problem som driftsleverandøren?</li>
								<li>Endte med at salgsorganisasjonen betalte for å migrere resten av appene over på det "smidige driftsmiljøet"</li>
								-->
							</ul>
						</aside>
					</section>

					<section data-slide-type="poeng">
						<h2>IT-arkitektur er forretningsbehov</h2>
						<!-- Sørg for at forretning ser og får cashet ut verdien av de tekniske forbedringene! -->
						<aside class="notes">
							<ul>
								<li>"Hvorfor tar noen apper kort tid å endre?"</li>
								<li>Salg/produkteiere betalte for migrering</li>
								<li>Forretning må skjønne hva vi gjør</li>
								<li>Kortere time to marked</li>
								<li>Vis og bevis!</li>
								<li>Ingen effekt for andre enn IT? Bør du?</li>
							</ul>
							<!--
							Synliggjør verdien av IT-oppgavene for andre enn
							IT. Sparer du penger? Kortere time to market? Vis
							og bevis det! Har det ingen effekt som er synlig
							for andre enn IT? Bør du egentlig gjøre det da..?
							-->
						</aside>
					</section>
				</section>

				<section id="industrialisering" data-owner="stian">
					<!-- http://www.iso.org/iso/news.htm?refid=Ref1701 -->
					<section data-background="img/cake.jpg">
						<div class="header" style="color: #F10000">
							<div class="caption">Vi har…</div>
							<h2 style="color: inherit;">
								Industrialisert utvikling og utrulling
							</h2>
						</div>

						<aside class="notes">
							<ul>
								<li>Kostnad per app ned</li>
								<li>Fikk ny type kompleksitet</li>
								<li>Micro service fører til industrialisering</li>
							</ul>
						</aside>
						<!--
						Ut fra de erfaringene vi gjorde oss, ble stadig mindre
						applikasjoner en naturlig følge. Kostnaden per
						applikasjon ble drevet ned, men med kjøpet fikk vi
						annen type kompleksitet enn vi var vant til.
						Applikasjonsutvikling og -drift måtte industrialiseres,
						og vi gikk inn i microservice-tidsalderen. Vi lærte at
						vi trengte logaggregering, monitorering, isolasjon
						mellom applikasjoner, automatisk failover for kritisk
						funksjonalitet, valg av desentraliserte teknologier som
						OAuth for kjernekomponenter og mye annet.
						-->
					</section>

					<section data-slide-type="smerte">
						<img src="img/logs.png" alt="Logs across applications">
						<aside class="notes">
							<ul>
								<li>Det ble veldig komplekst å deploye en app.</li>
								<li>Måtte følge med i 4 fire logger på 2 servere samtidig!</li>
								<li>Var vanskelig å gjøre drift, for miljøet begynte å bli komplekst.</li>
							</ul>
						</aside>
					</section>

					<section data-slide-type="poeng">
						<img src="img/kibana2.png" alt="Kibana">
					</section>

					<section data-slide-type="poeng">
						<h2>Støtteverktøy</h2>
						<ul>
							<li>Loggagregering</li>
							<li>Helsesjekker</li>
							<li>Monitorering</li>
							<li>Isolasjon mellom apper</li>
							<li>Automatisk failover</li>
							<li>Autentisering av applikasjoner</li>
						</ul>

						<aside class="notes">
							<ul>
								<li>Fjerner kompleksiteten med monolitter, men introduserer en ny kompleksitet</li>
								<li>Invester mer i infrastruktur</li>
								<li>Automatiserer implisitte oppgaver</li>
							</ul>
						</aside>
					</section>

					<section data-slide-type="poeng">
						<h2>Standardisering?</h2>

						<aside class="notes">
							<ul>
								<li>Micro services brukes som et argument for at man kan bruke flere teknologier</li>
								<li>Vår erfaring er at man i meste fall tåler like mange</li>
								<li>Prisen for kontekstbytte for både utviklere og driftere er stor</li>
							</ul>
						</aside>
					</section>
				</section>


				<section id="ende-til-ende-testing" data-owner="jøran">
					<section>
						Det suger balle å ikke ha ende-til-ende-tester
					</section>

					<section>
						TODO
					</section>
				</section>


				<section>
					The end is near
				</section>

				<section id="hovedpoeng">
					<section>
						<h1>Konklusjonen</h1>

						<aside class="notes">
							Pek tilbake til konklusjonen vi teasa med tidligere
						</aside>
					</section>

					<section>
						<ul>
							<li>Gjør én forbedring om gangen</li>
							<li>Løs problemer når du har dem</li>
							<li>Gjør ting enkelt!</li>
						</ul>

						<aside class="notes">
							TODO: Finn ut hvordan vi strukturerer disse. Egne slides per poeng?<br/>

							Du kan ikke "implementere DevOps" eller "lage micro services". Dette er noe som må vokse frem organisk gjennom at et ansvarliggjort team føler på smerter og har lov til å lage løsninger. Ikke bygg platform for å bygge platform!
						</aside>
					</section>
				</section>


				<section id="oppsummering">
					<section>
						Oppsummér poengene som har vært gjort så langt.

						<aside class="notes">
							Denne kan fjernes hvis presentasjonen blir for lang
						</aside>
					</section>
				</section>

				<section>
					<section>Spørsmål?</section>

					<section>Takk for oss!</section>
				</section>

			</div>

		</div>

		<script src="lib/js/underscore-min.js"></script>
		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			var slideTypeToBgImage = {
				tabbe: 'img/pain.jpg', // http://www.oxfordtoday.ox.ac.uk/features/pain-always-real
				smerte: 'img/pain.jpg',
				poeng: 'img/idea.jpg' // http://images.huffingtonpost.com/2015-01-20-IdeasMakeorBreakYourBusiness.jpg
				//visdomsord: '',
			};

			_.chain(document.getElementsByTagName('section'))
				.filter(function(e) { return e.dataset['slideType']; })
				.filter(function(e) { return slideTypeToBgImage[e.dataset['slideType']]; })
				.each(function(e) {
					e.dataset['background'] = slideTypeToBgImage[e.dataset['slideType']];
					e.style.backgroundColor = 'rgba(0, 0, 0, 0.75)';
				});

			// Add speaker notes to all slides
			_.chain(document.getElementsByTagName("section"))
				.filter(function(e) { return _.isEmpty(e.getElementsByTagName("section"))})
				.filter(function(e) { return _.isEmpty(e.querySelectorAll("aside.notes"))})
				.forEach(function(e) {
					var notes = document.createElement("aside");
					notes.className = "notes";
					e.appendChild(notes);
				});

			// Add owner to all speaker notes
			_.chain(document.getElementsByTagName("section"))
				.filter(function(e) { return e.dataset.owner })
				.each(function(e) { _.each(e.querySelectorAll("aside.notes"), function(n) {
					n.dataset.owner = e.dataset.owner;
				})
			})

			// Add next owner of next slide to notes
			_.chain(document.querySelectorAll("aside.notes"))
				.reduce(function(prev, next) {
					prev.dataset.nextowner = next.dataset.owner;
					return next;
				})

			var people = {
				stian: "../../img/hovercat.jpg",
				'jøran': "../../img/lillesand.jpeg"
			};

			_.chain(document.querySelectorAll("aside.notes"))
				.each(function(e) {
					var current = document.createElement("img");
					var next = document.createElement("img");

					var size = 4;

					current.style.position = "fixed";
					current.style.left = "0em";
					current.style.bottom = "0em";
					current.style.height = size + "em";
					current.style.width = size + "em";
					current.style.zIndex = 100;

					next.style.position = "fixed";
					next.style.left = size + "em";
					next.style.bottom = "0em";
					next.style.height = size + "em";
					next.style.width = size + "em";
					next.style.zIndex = 100;

					current.src = people[e.dataset.owner];
					next.src = people[e.dataset.nextowner];

					e.appendChild(current);
					if (e.dataset.owner !== e.dataset.nextowner) {
						e.appendChild(next);
					}
			});





			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: false,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>


	</body>
</html>
